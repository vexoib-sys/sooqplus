<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحتي - السوق المفتوح</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <h1>لوحتي - السوق المفتوح</h1>
            </div>
            <div class="nav-links">
                <a href="index.html">الرئيسية</a>
                <a href="post-ad.html">أضف إعلان</a>
                <a href="user-dashboard.html" class="active">لوحتي</a>
                <a href="#" onclick="logout(); return false;">تسجيل الخروج</a>
            </div>
        </div>
    </nav>

    <!-- User Dashboard -->
    <section class="user-dashboard">
        <div class="container">
            <div class="user-dashboard-header">
                <h2>لوحة تحكمي</h2>
                <div class="user-stats">
                    <div class="stat-card">
                        <h3 id="userTotalAds">0</h3>
                        <p>إجمالي إعلاناتي</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="userActiveAds">0</h3>
                        <p>إعلانات نشطة</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="userPendingAds">0</h3>
                        <p>قيد المراجعة</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="userRejectedAds">0</h3>
                        <p>مرفوضة</p>
                    </div>
                </div>
            </div>

            <!-- User Info Card -->
            <div class="user-info-card">
                <h3>معلوماتي الشخصية</h3>
                <div id="userInfoContent">
                    <!-- User info will be loaded here -->
                </div>
            </div>

            <!-- User Tabs -->
            <div class="user-tabs">
                <button class="user-tab-btn active" onclick="showUserTab('myAds', this)">إعلاناتي</button>
                <button class="user-tab-btn" onclick="showUserTab('profile', this)">الملف الشخصي</button>
            </div>

            <!-- My Ads Tab -->
            <div id="myAdsTab" class="user-tab-content active">
                <div class="user-actions">
                    <input type="text" id="searchMyAds" placeholder="بحث في إعلاناتي..." onkeyup="searchMyAds()">
                    <select id="filterMyAdsStatus" onchange="filterMyAds()">
                        <option value="all">جميع الحالات</option>
                        <option value="active">نشط</option>
                        <option value="pending">قيد المراجعة</option>
                        <option value="rejected">مرفوض</option>
                    </select>
                    <button class="btn-primary" onclick="window.location.href='post-ad.html'">إضافة إعلان جديد</button>
                </div>
                <div id="myAdsList" class="user-ads-list">
                    <!-- User ads will be loaded here -->
                </div>
            </div>

            <!-- Profile Tab -->
            <div id="profileTab" class="user-tab-content">
                <div class="profile-section">
                    <h3>تعديل الملف الشخصي</h3>
                    <form id="profileForm" onsubmit="handleUpdateProfile(event)">
                        <div class="form-group">
                            <label for="profileName">الاسم الكامل</label>
                            <input type="text" id="profileName" required>
                        </div>
                        <div class="form-group">
                            <label for="profileEmail">البريد الإلكتروني</label>
                            <input type="email" id="profileEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="profilePhone">رقم الهاتف</label>
                            <input type="tel" id="profilePhone" required>
                        </div>
                        <div class="form-group">
                            <label for="currentPassword">كلمة المرور الحالية (للتأكيد)</label>
                            <input type="password" id="currentPassword">
                        </div>
                        <div class="form-group">
                            <label for="newPassword">كلمة المرور الجديدة (اختياري)</label>
                            <input type="password" id="newPassword" minlength="6">
                        </div>
                        <button type="submit" class="btn-primary">حفظ التغييرات</button>
                    </form>
                    <div id="profileMessage" class="success-message" style="display:none;"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modal for Edit My Ad -->
    <div id="editMyAdModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('editMyAdModal')">&times;</span>
            <h3>تعديل إعلاني</h3>
            <form id="editMyAdForm" onsubmit="handleEditMyAd(event)">
                <input type="hidden" id="editMyAdId">
                <div class="form-group">
                    <label>العنوان</label>
                    <input type="text" id="editMyAdTitle" required>
                </div>
                <div class="form-group">
                    <label>الفئة</label>
                    <select id="editMyAdCategory" required></select>
                </div>
                <div class="form-group">
                    <label>السعر</label>
                    <input type="number" id="editMyAdPrice" required>
                </div>
                <div class="form-group">
                    <label>الموقع</label>
                    <input type="text" id="editMyAdLocation" required>
                </div>
                <div class="form-group">
                    <label>رقم الهاتف</label>
                    <input type="tel" id="editMyAdPhone" required>
                </div>
                <div class="form-group">
                    <label>الوصف</label>
                    <textarea id="editMyAdDescription" rows="4" required></textarea>
                </div>
                <button type="submit" class="btn-primary">حفظ التغييرات</button>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="user-dashboard.js"></script>
    <script>
        // Check if user is logged in
        if (!isLoggedIn()) {
            alert('يجب تسجيل الدخول أولاً');
            window.location.href = 'login.html';
        }
        updateSiteName();
        updateSiteColor();
        loadUserDashboard();
    </script>
</body>
</html>

